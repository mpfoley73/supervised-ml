"0","xform1 <- function(x) {2 * x + runif(1, 0.5, 2)}"
"0","xform2 <- function(x) {2 * x + runif(1, -2, -0.5)}"
"0",""
"0","set.seed(1234)"
"0","x <- data.frame(x = runif(20, -1, 3), grp = c(rep(""b"", 10), rep(""r"", 10))) %>%"
"0","  mutate("
"0","    y1 = map_dbl(x, xform1),"
"0","    y2 = map_dbl(x, xform2),"
"0","    y = if_else(grp == ""b"", y1, y2)"
"0","  )"
"0",""
"0","x %>%"
"0","  ggplot(aes(x = x, y = y, color = grp)) +"
"0","  geom_point(show.legend = FALSE) +"
"0","  geom_abline(slope = 2, intercept = 0, linewidth = 1) +"
"0","  geom_abline(slope = 2, intercept = -.70, linetype = 2) +"
"0","  geom_abline(slope = 2, intercept = +.66, linetype = 2) +"
"0","  annotate(""segment"", x = x[10,]$x, y = x[10,]$y, xend = 1.125, yend = 2.2, "
"0","           linetype = 3, linewidth = 1, color = ""red"") +"
"0","  annotate(""segment"", x = x[4,]$x, y = x[4,]$y, xend = 1.565, yend = 3.03, "
"0","           linetype = 3, linewidth = 1, color = ""red"") +"
"0","  annotate(""segment"", x = x[20,]$x, y = x[20,]$y, xend = -.125, yend = -.32, "
"0","           linetype = 3, linewidth = 1, color = ""skyblue"") +"
"0","  labs(x = NULL, y = NULL, color = NULL) +"
"0","  theme_minimal()"
