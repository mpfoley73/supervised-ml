"0","# Actual values (1s and 0s for three response levels)"
"0","y <- cs2$dat %>% "
"0","  mutate(val = 1) %>% "
"0","  pivot_wider(names_from = prog, values_from = val, values_fill = 0) %>%"
"0","  select(levels(cs2$dat$prog)) %>%"
"0","  as.matrix()"
"0",""
"0","# Predicted values (probabilities for three response levels)"
"0","pi <- predict(cs2$result, type = ""prob"") * 1"
"0",""
"0","# Raw residuals, by hand or by formula"
"0","# e <- y - pi"
"0","e <- residuals(cs2$result, type = ""response"")"
"0",""
"0","# Deviance residuals"
"0","d <- sign(e) * sqrt(-2 * y * log(pi) + (1 - y) * log(1 - pi))"
"0",""
"0","(g2 <- sum(d^2, na.rm = TRUE))"
"1","[1]"
"1"," 359.9635"
"1","
"
"0","(g2 <- 2 * sum(y * log(y / pi), na.rm = TRUE))"
"1","[1]"
"1"," 359.9635"
"1","
"
"0","(g2 <- deviance(cs2$result))"
"1","[1]"
"1"," 359.9635"
"1","
"
