"0","# Create the model. This much is the same for parsnip or recipes."
"0","cs2$model <-"
"0","  multinom_reg() %>%"
"0","  set_engine(""nnet"")"
"0",""
"0","# For parsnip, you need to normalize the data explicitly. nnet requires dummy"
"0","# vars for factor predictors, but thankfully parsnip does that implicitly. "
"0","# However, I want the outcome variable base level to be ""academic"" and while"
"0","# recipes can do that in pre-processing, I have to do it manually for parsnip."
"0","cs2$dat_normalized <-"
"0","  cs2$dat %>%"
"0","  # Cast to numeric, otherwise scale() returns an nmatrix. :("
"0","  mutate(write = as.numeric(scale(write, center = TRUE, scale = TRUE)))"
"0",""
"0","# Fit the whole data set for an explanatory model."
"0","cs2$fit <-"
"0","  cs2$model %>%"
"0","  fit(prog ~ ses + write, data = cs2$dat_normalized)"
"0",""
"0","# Extract the fit object returned by the engine. Use for interpretation and "
"0","# checking assumptions."
"0","cs2$result <-"
"0","  cs2$fit %>%"
"0","  extract_fit_engine()"
