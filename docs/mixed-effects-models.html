<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Mixed Effects Models | Supervised Machine Learning</title>
  <meta name="description" content="These are my personal notes related to supervised machine learning techniques." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Mixed Effects Models | Supervised Machine Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These are my personal notes related to supervised machine learning techniques." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Mixed Effects Models | Supervised Machine Learning" />
  
  <meta name="twitter:description" content="These are my personal notes related to supervised machine learning techniques." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-12-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="BayesRegression.html"/>
<link rel="next" href="references-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Supervised Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>1</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#parameter-estimation"><i class="fa fa-check"></i><b>1.1</b> Parameter Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#model-assumptions"><i class="fa fa-check"></i><b>1.2</b> Model Assumptions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multicollinearity"><i class="fa fa-check"></i><b>1.2.1</b> Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#prediction"><i class="fa fa-check"></i><b>1.3</b> Prediction</a></li>
<li class="chapter" data-level="1.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#inference"><i class="fa fa-check"></i><b>1.4</b> Inference</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#t-test"><i class="fa fa-check"></i><b>1.4.1</b> <em>t</em>-Test</a></li>
<li class="chapter" data-level="1.4.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#f-test"><i class="fa fa-check"></i><b>1.4.2</b> <em>F</em>-Test</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#interpretation"><i class="fa fa-check"></i><b>1.5</b> Interpretation</a></li>
<li class="chapter" data-level="1.6" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#model-validation"><i class="fa fa-check"></i><b>1.6</b> Model Validation</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#accuracy-metrics"><i class="fa fa-check"></i><b>1.6.1</b> Accuracy Metrics</a></li>
<li class="chapter" data-level="1.6.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#r-squared"><i class="fa fa-check"></i><b>1.6.2</b> R-Squared</a></li>
<li class="chapter" data-level="1.6.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#cross-validation"><i class="fa fa-check"></i><b>1.6.3</b> Cross-Validation</a></li>
<li class="chapter" data-level="1.6.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#gain-curve"><i class="fa fa-check"></i><b>1.6.4</b> Gain Curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html"><i class="fa fa-check"></i><b>2</b> Generalized Linear Models (GLM)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#binomiallogistic"><i class="fa fa-check"></i><b>2.1</b> Binomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#cs1"><i class="fa fa-check"></i>Case Study</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#fit-the-model"><i class="fa fa-check"></i>Fit the Model</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#interpretation-1"><i class="fa fa-check"></i>Interpretation</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#assumptions"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#evaluate-the-fit"><i class="fa fa-check"></i>Evaluate the Fit</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#reporting"><i class="fa fa-check"></i>Reporting</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#multinomiallogistic"><i class="fa fa-check"></i><b>2.2</b> Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#cs2"><i class="fa fa-check"></i>Case Study</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#fit-the-model-1"><i class="fa fa-check"></i>Fit the Model</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#interpretation-2"><i class="fa fa-check"></i>Interpretation</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#assumptions-1"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#evaluate-the-fit-1"><i class="fa fa-check"></i>Evaluate the Fit</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#reporting-1"><i class="fa fa-check"></i>Reporting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#ordinallogistic"><i class="fa fa-check"></i><b>2.3</b> Ordinal Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#cs3"><i class="fa fa-check"></i>Case Study</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#fit-the-model-2"><i class="fa fa-check"></i>Fit the Model</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#assumptions-2"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#evaluate-the-fit-2"><i class="fa fa-check"></i>Evaluate the Fit</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#interpret-results"><i class="fa fa-check"></i>Interpret Results</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#reporting-2"><i class="fa fa-check"></i>Reporting</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#poissonregression"><i class="fa fa-check"></i><b>2.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="" data-path="generalized-linear-models-glm.html"><a href="generalized-linear-models-glm.html#cs4"><i class="fa fa-check"></i>Case Study 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>3</b> Regularization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="regularization.html"><a href="regularization.html#ridge"><i class="fa fa-check"></i><b>3.1</b> Ridge</a></li>
<li class="chapter" data-level="3.2" data-path="regularization.html"><a href="regularization.html#lasso"><i class="fa fa-check"></i><b>3.2</b> Lasso</a></li>
<li class="chapter" data-level="3.3" data-path="regularization.html"><a href="regularization.html#elastic-net"><i class="fa fa-check"></i><b>3.3</b> Elastic Net</a></li>
<li class="chapter" data-level="" data-path="regularization.html"><a href="regularization.html#model-summary"><i class="fa fa-check"></i>Model Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>4</b> Decision Trees</a>
<ul>
<li class="chapter" data-level="4.1" data-path="decision-trees.html"><a href="decision-trees.html#classification-tree"><i class="fa fa-check"></i><b>4.1</b> Classification Tree</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="decision-trees.html"><a href="decision-trees.html#measuring-performance"><i class="fa fa-check"></i><b>4.1.1</b> Measuring Performance</a></li>
<li class="chapter" data-level="4.1.2" data-path="decision-trees.html"><a href="decision-trees.html#training-with-caret"><i class="fa fa-check"></i><b>4.1.2</b> Training with Caret</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="decision-trees.html"><a href="decision-trees.html#regression-tree"><i class="fa fa-check"></i><b>4.2</b> Regression Tree</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="decision-trees.html"><a href="decision-trees.html#training-with-caret-1"><i class="fa fa-check"></i><b>4.2.1</b> Training with Caret</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="decision-trees.html"><a href="decision-trees.html#bagged-trees"><i class="fa fa-check"></i><b>4.3</b> Bagged Trees</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="decision-trees.html"><a href="decision-trees.html#bagged-classification-tree"><i class="fa fa-check"></i><b>4.3.1</b> Bagged Classification Tree</a></li>
<li class="chapter" data-level="4.3.2" data-path="decision-trees.html"><a href="decision-trees.html#bagging-regression-tree"><i class="fa fa-check"></i><b>4.3.2</b> Bagging Regression Tree</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="decision-trees.html"><a href="decision-trees.html#random-forests"><i class="fa fa-check"></i><b>4.4</b> Random Forests</a></li>
<li class="chapter" data-level="4.5" data-path="decision-trees.html"><a href="decision-trees.html#gradient-boosting"><i class="fa fa-check"></i><b>4.5</b> Gradient Boosting</a></li>
<li class="chapter" data-level="4.6" data-path="decision-trees.html"><a href="decision-trees.html#summary"><i class="fa fa-check"></i><b>4.6</b> Summary</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="decision-trees.html"><a href="decision-trees.html#classification-trees"><i class="fa fa-check"></i><b>4.6.1</b> Classification Trees</a></li>
<li class="chapter" data-level="4.6.2" data-path="decision-trees.html"><a href="decision-trees.html#regression-trees"><i class="fa fa-check"></i><b>4.6.2</b> Regression Trees</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="non-linear-models.html"><a href="non-linear-models.html"><i class="fa fa-check"></i><b>5</b> Non-linear Models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="non-linear-models.html"><a href="non-linear-models.html#splines"><i class="fa fa-check"></i><b>5.1</b> Splines</a></li>
<li class="chapter" data-level="5.2" data-path="non-linear-models.html"><a href="non-linear-models.html#mars"><i class="fa fa-check"></i><b>5.2</b> MARS</a></li>
<li class="chapter" data-level="5.3" data-path="non-linear-models.html"><a href="non-linear-models.html#gam"><i class="fa fa-check"></i><b>5.3</b> GAM</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>6</b> Support Vector Machines</a>
<ul>
<li class="chapter" data-level="6.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#maximal-margin-classifier"><i class="fa fa-check"></i><b>6.1</b> Maximal Margin Classifier</a></li>
<li class="chapter" data-level="6.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#support-vector-classifier"><i class="fa fa-check"></i><b>6.2</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="6.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#support-vector-machines-1"><i class="fa fa-check"></i><b>6.3</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="EMMs.html"><a href="EMMs.html"><i class="fa fa-check"></i><b>7</b> Topics: EMMs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="EMMs.html"><a href="EMMs.html#references"><i class="fa fa-check"></i><b>7.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="BayesRegression.html"><a href="BayesRegression.html"><i class="fa fa-check"></i><b>8</b> Bayesian Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="BayesRegression.html"><a href="BayesRegression.html#compared-to-frequentist-regression"><i class="fa fa-check"></i><b>8.1</b> Compared to Frequentist Regression</a></li>
<li class="chapter" data-level="8.2" data-path="BayesRegression.html"><a href="BayesRegression.html#model-evaluation"><i class="fa fa-check"></i><b>8.2</b> Model Evaluation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="BayesRegression.html"><a href="BayesRegression.html#model-comparison"><i class="fa fa-check"></i><b>8.2.1</b> Model Comparison</a></li>
<li class="chapter" data-level="8.2.2" data-path="BayesRegression.html"><a href="BayesRegression.html#visualization"><i class="fa fa-check"></i><b>8.2.2</b> Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html"><i class="fa fa-check"></i><b>9</b> Mixed Effects Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#lme"><i class="fa fa-check"></i><b>9.1</b> Linear Mixed Effects</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#lme1"><i class="fa fa-check"></i>Case Study</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#fit-the-model-3"><i class="fa fa-check"></i>Fit the Model</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#interpretation-3"><i class="fa fa-check"></i>Interpretation</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#assumptions-3"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#evaluate-the-fit-3"><i class="fa fa-check"></i>Evaluate the Fit</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#reporting-3"><i class="fa fa-check"></i>Reporting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supervised Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mixed-effects-models" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Mixed Effects Models<a href="mixed-effects-models.html#mixed-effects-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Linear mixed effects models are used for cases in which there are multiple observations from the subjects. Multiple observations violates the independence assumption of linear regression. Repeated measures ANOVA is a popular way to analyze this kind of data, but it has several shortcomings. It does not control for covariates well, does not handle missing observations within a subject, requires a continuous outcome on categorical predictors, and does not estimate the magnitude or direction of effects <span class="citation">(<a href="#ref-Brown2021">Brown 2021</a>)</span>.</p>
<p>Linear mixed effects models address all of the shortcomings of repeated measures ANOVA, and can be generalized into categorical outcomes a well.</p>
<div id="lme" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Linear Mixed Effects<a href="mixed-effects-models.html#lme" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Logistic regression estimates the probability that a categorical dependent variable is a particular level. The dependent variable levels can be binomial, multinomial, or ordinal. The <em>binary</em> logistic regression model is</p>
<p><span class="math display">\[y_i = \mathrm{logit}(\pi_i) = \log \left( \frac{\pi_i}{1 - \pi_i} \right) = X_i \beta\]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the response <span class="math inline">\(i\)</span>’s binary level probability. The model predicts the <em>log odds</em> of the level. Why do this? The range of outcomes need to be between 0 and 1, and a sigmoid function, <span class="math inline">\(f(y) = 1 / \left(1 + e^y \right)\)</span>, does that. If the <em>log odds</em> of the level equals <span class="math inline">\(X_i\beta\)</span>, then the <em>odds</em> of the level equals <span class="math inline">\(e^{X\beta}\)</span>. You can solve for <span class="math inline">\(\pi_i\)</span> to get <span class="math inline">\(\pi = \mathrm{odds} / (\mathrm{odds} + 1)\)</span>. Substituting,</p>
<p><span class="math display">\[\pi_i = \frac{\exp(y_i)}{1 + \exp(y_i)} = \frac{e^{X_i\beta}}{1 + e^{X_i\beta}}\]</span></p>
<p>which you can simplify to <span class="math inline">\(\pi_i = 1 / (1 + e^{-X_i\beta})\)</span>, a sigmoid function. The upshot is <span class="math inline">\(X\beta\)</span> is the functional relationship between the independent variables and <em>a function of the response</em>, not the response itself.</p>
<p>The model parameters are estimated either by <em>iteratively reweighted least squares optimization</em> or by <em>maximum likelihood estimation</em> (MLE). MLE maximizes the probability produced by a set of parameters <span class="math inline">\(\beta\)</span> given a data set and probability distribution.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> In logistic regression the probability distribution is the binomial and each observation is the outcome of a single Bernoulli trial.</p>
<p><span class="math display">\[L(\beta; y, X) = \prod_{i=1}^n \pi_i^{y_i}(1 - \pi_i)^{(1-y_i)} = \prod_{i=1}^n\frac{\exp(y_i X_i \beta)}{1 + \exp(X_i \beta)}.\]</span></p>
<p>In practice, multiplying many small probabilities can be unstable, so MLE optimizes the log likelihood instead.</p>
<p><span class="math display">\[\begin{align}
l(\beta; y, X) &amp;= \sum_{i = 1}^n \left(y_i \log(\pi_i) + (1 - y_i) \log(1 - \pi_i) \right) \\
               &amp;= \sum_{i = 1}^n \left(y_i X_i \beta - \log(1 + e^{X_i\beta}) \right)
\end{align}\]</span></p>
<p>Sometimes you will see the <em>cost function</em> optimized. The cost function is the negative of of the log likelihood function.</p>
<p><strong>Assumptions</strong></p>
<p>The binomial logistic regression model requires a dichotomous dependent variable and independent observations. The sample size should be large, at least 10 observations per dependent variable level and independent variable. There are three conditions related to the data distribution: i) the logit transformation must be linearly related to any continuous independent variables, ii) there must be no multicollinearity, and iii) there must be no influential outliers.</p>
<p>Be aware of over-dispersion, a common issue with GLM. For a binomial logistic regression, the response variable should be distributed <span class="math inline">\(y_i \sim \mathrm{Bin}(n_i, \pi_i)\)</span> with <span class="math inline">\(\mu_i = n_i \pi_i\)</span> and <span class="math inline">\(\sigma^2 = \pi (1 - \pi)\)</span>. Over-dispersion means the data shows evidence of variance greater than <span class="math inline">\(\sigma^2\)</span>.</p>
<div id="lme1" class="section level3 unnumbered hasAnchor">
<h3>Case Study<a href="mixed-effects-models.html#lme1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This case study uses data from <span class="citation">Brown (<a href="#ref-Brown2021">2021</a>)</span>’s <a href="https://statistics.laerd.com/">Laerd Statistics</a> article on binomial logistic regression <a href="https://statistics.laerd.com/premium/spss/spss-files/logistic-regression.sav">data set</a>. A study investigates the relationship between the incidence of heart disease (Yes|No) and age, weight, gender, and maximal aerobic capacity using data from <em>n</em> = 100 participants.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="mixed-effects-models.html#cb3-1" tabindex="-1"></a>cs1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-2"><a href="mixed-effects-models.html#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="mixed-effects-models.html#cb3-3" tabindex="-1"></a>cs1<span class="sc">$</span>dat <span class="ot">&lt;-</span> foreign<span class="sc">::</span><span class="fu">read.spss</span>(<span class="st">&quot;./input/logistic-regression.sav&quot;</span>, <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a href="mixed-effects-models.html#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="mixed-effects-models.html#cb3-5" tabindex="-1"></a>cs1<span class="sc">$</span>dat <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="mixed-effects-models.html#cb3-6" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb3-7"><a href="mixed-effects-models.html#cb3-7" tabindex="-1"></a>    <span class="at">by =</span> heart_disease,</span>
<span id="cb3-8"><a href="mixed-effects-models.html#cb3-8" tabindex="-1"></a>    <span class="at">include =</span> <span class="sc">-</span>caseno,</span>
<span id="cb3-9"><a href="mixed-effects-models.html#cb3-9" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">&quot;row&quot;</span>,</span>
<span id="cb3-10"><a href="mixed-effects-models.html#cb3-10" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(gtsummary<span class="sc">::</span><span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">&quot;{mean}, {sd}&quot;</span>)</span>
<span id="cb3-11"><a href="mixed-effects-models.html#cb3-11" tabindex="-1"></a>  )</span></code></pre></div>
<div id="znmqikmuuo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#znmqikmuuo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#znmqikmuuo thead, #znmqikmuuo tbody, #znmqikmuuo tfoot, #znmqikmuuo tr, #znmqikmuuo td, #znmqikmuuo th {
  border-style: none;
}

#znmqikmuuo p {
  margin: 0;
  padding: 0;
}

#znmqikmuuo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#znmqikmuuo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#znmqikmuuo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#znmqikmuuo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#znmqikmuuo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#znmqikmuuo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znmqikmuuo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#znmqikmuuo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#znmqikmuuo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#znmqikmuuo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#znmqikmuuo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#znmqikmuuo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#znmqikmuuo .gt_spanner_row {
  border-bottom-style: hidden;
}

#znmqikmuuo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#znmqikmuuo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#znmqikmuuo .gt_from_md > :first-child {
  margin-top: 0;
}

#znmqikmuuo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#znmqikmuuo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#znmqikmuuo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#znmqikmuuo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#znmqikmuuo .gt_row_group_first td {
  border-top-width: 2px;
}

#znmqikmuuo .gt_row_group_first th {
  border-top-width: 2px;
}

#znmqikmuuo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#znmqikmuuo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#znmqikmuuo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#znmqikmuuo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znmqikmuuo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#znmqikmuuo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#znmqikmuuo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#znmqikmuuo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#znmqikmuuo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znmqikmuuo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#znmqikmuuo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#znmqikmuuo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#znmqikmuuo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#znmqikmuuo .gt_left {
  text-align: left;
}

#znmqikmuuo .gt_center {
  text-align: center;
}

#znmqikmuuo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#znmqikmuuo .gt_font_normal {
  font-weight: normal;
}

#znmqikmuuo .gt_font_bold {
  font-weight: bold;
}

#znmqikmuuo .gt_font_italic {
  font-style: italic;
}

#znmqikmuuo .gt_super {
  font-size: 65%;
}

#znmqikmuuo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#znmqikmuuo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#znmqikmuuo .gt_indent_1 {
  text-indent: 5px;
}

#znmqikmuuo .gt_indent_2 {
  text-indent: 10px;
}

#znmqikmuuo .gt_indent_3 {
  text-indent: 15px;
}

#znmqikmuuo .gt_indent_4 {
  text-indent: 20px;
}

#znmqikmuuo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;No&lt;/strong&gt;, N = 65&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>No</strong>, N = 65<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Yes&lt;/strong&gt;, N = 35&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>Yes</strong>, N = 35<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">age</td>
<td headers="stat_1" class="gt_row gt_center">39, 8</td>
<td headers="stat_2" class="gt_row gt_center">45, 9</td></tr>
    <tr><td headers="label" class="gt_row gt_left">weight</td>
<td headers="stat_1" class="gt_row gt_center">77, 14</td>
<td headers="stat_2" class="gt_row gt_center">85, 15</td></tr>
    <tr><td headers="label" class="gt_row gt_left">gender</td>
<td headers="stat_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Female</td>
<td headers="stat_1" class="gt_row gt_center">29 (78%)</td>
<td headers="stat_2" class="gt_row gt_center">8 (22%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Male</td>
<td headers="stat_1" class="gt_row gt_center">36 (57%)</td>
<td headers="stat_2" class="gt_row gt_center">27 (43%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">VO2max</td>
<td headers="stat_1" class="gt_row gt_center">45, 9</td>
<td headers="stat_2" class="gt_row gt_center">41, 6</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean, SD; n (%)</td>
    </tr>
  </tfoot>
</table>
</div>
<p><br></p>
<p>Overall, men are twice as likely to have heart disease. Male odds are .43/.57 = 0.8 and female odds are .22/.78 = 0.3, an male-to-female odds ratio of 2.7.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="mixed-effects-models.html#cb4-1" tabindex="-1"></a>cs1<span class="sc">$</span>dat <span class="sc">%&gt;%</span> gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">row =</span> heart_disease, <span class="at">col =</span> gender, <span class="at">percent =</span> <span class="st">&quot;col&quot;</span>) </span></code></pre></div>
<div id="ajtmykkpqb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ajtmykkpqb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ajtmykkpqb thead, #ajtmykkpqb tbody, #ajtmykkpqb tfoot, #ajtmykkpqb tr, #ajtmykkpqb td, #ajtmykkpqb th {
  border-style: none;
}

#ajtmykkpqb p {
  margin: 0;
  padding: 0;
}

#ajtmykkpqb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ajtmykkpqb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ajtmykkpqb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ajtmykkpqb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ajtmykkpqb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ajtmykkpqb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ajtmykkpqb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ajtmykkpqb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ajtmykkpqb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ajtmykkpqb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ajtmykkpqb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ajtmykkpqb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ajtmykkpqb .gt_spanner_row {
  border-bottom-style: hidden;
}

#ajtmykkpqb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ajtmykkpqb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ajtmykkpqb .gt_from_md > :first-child {
  margin-top: 0;
}

#ajtmykkpqb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ajtmykkpqb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ajtmykkpqb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ajtmykkpqb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ajtmykkpqb .gt_row_group_first td {
  border-top-width: 2px;
}

#ajtmykkpqb .gt_row_group_first th {
  border-top-width: 2px;
}

#ajtmykkpqb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajtmykkpqb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ajtmykkpqb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ajtmykkpqb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ajtmykkpqb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajtmykkpqb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ajtmykkpqb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ajtmykkpqb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ajtmykkpqb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ajtmykkpqb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ajtmykkpqb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajtmykkpqb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ajtmykkpqb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajtmykkpqb .gt_left {
  text-align: left;
}

#ajtmykkpqb .gt_center {
  text-align: center;
}

#ajtmykkpqb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ajtmykkpqb .gt_font_normal {
  font-weight: normal;
}

#ajtmykkpqb .gt_font_bold {
  font-weight: bold;
}

#ajtmykkpqb .gt_font_italic {
  font-style: italic;
}

#ajtmykkpqb .gt_super {
  font-size: 65%;
}

#ajtmykkpqb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ajtmykkpqb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ajtmykkpqb .gt_indent_1 {
  text-indent: 5px;
}

#ajtmykkpqb .gt_indent_2 {
  text-indent: 10px;
}

#ajtmykkpqb .gt_indent_3 {
  text-indent: 15px;
}

#ajtmykkpqb .gt_indent_4 {
  text-indent: 20px;
}

#ajtmykkpqb .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id=""></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="gender">
        <span class="gt_column_spanner">gender</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="2" colspan="1" scope="col" id="Total">Total</th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Female">Female</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Male">Male</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">heart_disease</td>
<td headers="stat_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2" class="gt_row gt_center"><br /></td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    No</td>
<td headers="stat_1" class="gt_row gt_center">29 (78%)</td>
<td headers="stat_2" class="gt_row gt_center">36 (57%)</td>
<td headers="stat_0" class="gt_row gt_center">65 (65%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Yes</td>
<td headers="stat_1" class="gt_row gt_center">8 (22%)</td>
<td headers="stat_2" class="gt_row gt_center">27 (43%)</td>
<td headers="stat_0" class="gt_row gt_center">35 (35%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Total</td>
<td headers="stat_1" class="gt_row gt_center">37 (100%)</td>
<td headers="stat_2" class="gt_row gt_center">63 (100%)</td>
<td headers="stat_0" class="gt_row gt_center">100 (100%)</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Age, weight, and poor max aerobic capacity are positively associated with heart disease.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="mixed-effects-models.html#cb5-1" tabindex="-1"></a>cs1<span class="sc">$</span>dat <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="mixed-effects-models.html#cb5-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(age, weight, VO2max)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="mixed-effects-models.html#cb5-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heart_disease, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb5-4"><a href="mixed-effects-models.html#cb5-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="mixed-effects-models.html#cb5-5" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="mixed-effects-models.html#cb5-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(name), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="supervised-ml_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="rmdnote">
<p>Consider centering the continuous variables around their means to facilitate model interpretation. The intercept term in the fitted model would represent a reasonable condition, not a zero-aged, zero-weighted person with no aerobic capacity. This is the way to go if you want to present your findings in the framework of a baseline probability (or odds) and the incremental effects of the independent variables. You might also standardize the continuous vars to get a more meaningful increment. On the other hand, if you want to use your model for predicting outcomes, you’ll have to back out of the centering when you predict values.</p>
</div>
<p>If your model is predictive rather than inferential, split the data into training/testing data sets.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="mixed-effects-models.html#cb6-1" tabindex="-1"></a><span class="co"># For reproducibility</span></span>
<span id="cb6-2"><a href="mixed-effects-models.html#cb6-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-3"><a href="mixed-effects-models.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="mixed-effects-models.html#cb6-4" tabindex="-1"></a>(x <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(cs1<span class="sc">$</span>dat, <span class="at">prop =</span> <span class="fl">0.7</span>, <span class="at">strata =</span> heart_disease))</span>
<span id="cb6-5"><a href="mixed-effects-models.html#cb6-5" tabindex="-1"></a><span class="do">## &lt;Training/Testing/Total&gt;</span></span>
<span id="cb6-6"><a href="mixed-effects-models.html#cb6-6" tabindex="-1"></a><span class="do">## &lt;69/31/100&gt;</span></span>
<span id="cb6-7"><a href="mixed-effects-models.html#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="mixed-effects-models.html#cb6-8" tabindex="-1"></a>cs1<span class="sc">$</span>dat_training <span class="ot">&lt;-</span> <span class="fu">training</span>(x)</span>
<span id="cb6-9"><a href="mixed-effects-models.html#cb6-9" tabindex="-1"></a><span class="fu">dim</span>(cs1<span class="sc">$</span>dat_training)</span>
<span id="cb6-10"><a href="mixed-effects-models.html#cb6-10" tabindex="-1"></a><span class="do">## [1] 69  6</span></span>
<span id="cb6-11"><a href="mixed-effects-models.html#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="mixed-effects-models.html#cb6-12" tabindex="-1"></a>cs1<span class="sc">$</span>dat_testing <span class="ot">&lt;-</span> <span class="fu">testing</span>(x)</span>
<span id="cb6-13"><a href="mixed-effects-models.html#cb6-13" tabindex="-1"></a><span class="fu">dim</span>(cs1<span class="sc">$</span>dat_testing)</span>
<span id="cb6-14"><a href="mixed-effects-models.html#cb6-14" tabindex="-1"></a><span class="do">## [1] 31  6</span></span></code></pre></div>
</div>
<div id="fit-the-model-3" class="section level3 unnumbered hasAnchor">
<h3>Fit the Model<a href="mixed-effects-models.html#fit-the-model-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fit the model using the tidymodels framework. If you want to continue using the classic methodology, the glm object is inside the tidymodels fit. The model fit returns a brief summary with the coefficients and model diagnostics.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="mixed-effects-models.html#cb7-1" tabindex="-1"></a>cs1<span class="sc">$</span>model <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="mixed-effects-models.html#cb7-2" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="mixed-effects-models.html#cb7-3" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="mixed-effects-models.html#cb7-4" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>) </span>
<span id="cb7-5"><a href="mixed-effects-models.html#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="mixed-effects-models.html#cb7-6" tabindex="-1"></a>cs1<span class="sc">$</span>fit <span class="ot">&lt;-</span></span>
<span id="cb7-7"><a href="mixed-effects-models.html#cb7-7" tabindex="-1"></a>  cs1<span class="sc">$</span>model <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="mixed-effects-models.html#cb7-8" tabindex="-1"></a>  <span class="fu">fit</span>(heart_disease <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> VO2max <span class="sc">+</span> gender, <span class="at">data =</span> cs1<span class="sc">$</span>dat)</span>
<span id="cb7-9"><a href="mixed-effects-models.html#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="mixed-effects-models.html#cb7-10" tabindex="-1"></a><span class="co"># The fit object returned by glm(). You&#39;ll need this for interpretation and </span></span>
<span id="cb7-11"><a href="mixed-effects-models.html#cb7-11" tabindex="-1"></a><span class="co"># checking assumptions.</span></span>
<span id="cb7-12"><a href="mixed-effects-models.html#cb7-12" tabindex="-1"></a>cs1<span class="sc">$</span>result <span class="ot">&lt;-</span></span>
<span id="cb7-13"><a href="mixed-effects-models.html#cb7-13" tabindex="-1"></a>  cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="mixed-effects-models.html#cb7-14" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()</span>
<span id="cb7-15"><a href="mixed-effects-models.html#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="mixed-effects-models.html#cb7-16" tabindex="-1"></a><span class="co"># If you are fitting a predictive model, use the training set.</span></span>
<span id="cb7-17"><a href="mixed-effects-models.html#cb7-17" tabindex="-1"></a>cs1<span class="sc">$</span>fit_training <span class="ot">&lt;-</span></span>
<span id="cb7-18"><a href="mixed-effects-models.html#cb7-18" tabindex="-1"></a>  cs1<span class="sc">$</span>model <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="mixed-effects-models.html#cb7-19" tabindex="-1"></a>  <span class="fu">fit</span>(heart_disease <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> VO2max <span class="sc">+</span> gender, <span class="at">data =</span> cs1<span class="sc">$</span>dat_training)</span>
<span id="cb7-20"><a href="mixed-effects-models.html#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="mixed-effects-models.html#cb7-21" tabindex="-1"></a>cs1<span class="sc">$</span>result <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = heart_disease ~ age + weight + VO2max + 
##     gender, family = stats::binomial, data = data)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept) -1.676469   3.336079  -0.503  0.61530   
## age          0.085098   0.028160   3.022  0.00251 **
## weight       0.005727   0.022442   0.255  0.79858   
## VO2max      -0.099024   0.047944  -2.065  0.03889 * 
## genderMale   1.949639   0.842413   2.314  0.02065 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 129.49  on 99  degrees of freedom
## Residual deviance: 102.09  on 95  degrees of freedom
## AIC: 112.09
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>The null deviance, G^2, is the likelihood ratio of the intercept-only model with 69 rows - 1 parameter = 99 degrees of freedom. It is the sum of the squared deviance residuals. The residual deviance is the likelihood ratio of the full model with 100 - 5 parameters = 95 degrees of freedom.</p>
<p>The residual deviance is distributed chi-squared and can be used to test whether the model differs from the saturated model (model with as many coefficients as observations, G^2 = 0, <em>df</em> = 0) where <span class="math inline">\(H_0\)</span> = no difference. The deviance test for lack of fit fails to reject the null hypothesis.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="mixed-effects-models.html#cb9-1" tabindex="-1"></a><span class="co"># G^2 calculations</span></span>
<span id="cb9-2"><a href="mixed-effects-models.html#cb9-2" tabindex="-1"></a>cs1<span class="sc">$</span>result <span class="sc">%&gt;%</span> <span class="fu">residuals</span>(<span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>) <span class="sc">%&gt;%</span> .<span class="sc">^</span><span class="dv">2</span> <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb9-3"><a href="mixed-effects-models.html#cb9-3" tabindex="-1"></a><span class="do">## [1] 102.0878</span></span>
<span id="cb9-4"><a href="mixed-effects-models.html#cb9-4" tabindex="-1"></a>cs1<span class="sc">$</span>result <span class="sc">%&gt;%</span> <span class="fu">deviance</span>()</span>
<span id="cb9-5"><a href="mixed-effects-models.html#cb9-5" tabindex="-1"></a><span class="do">## [1] 102.0878</span></span>
<span id="cb9-6"><a href="mixed-effects-models.html#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="mixed-effects-models.html#cb9-7" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb9-8"><a href="mixed-effects-models.html#cb9-8" tabindex="-1"></a><span class="fu">df.residual</span>(cs1<span class="sc">$</span>result)</span>
<span id="cb9-9"><a href="mixed-effects-models.html#cb9-9" tabindex="-1"></a><span class="do">## [1] 95</span></span>
<span id="cb9-10"><a href="mixed-effects-models.html#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="mixed-effects-models.html#cb9-11" tabindex="-1"></a><span class="co"># G^2 is distributed chi-squared with df degrees of freedom</span></span>
<span id="cb9-12"><a href="mixed-effects-models.html#cb9-12" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fu">deviance</span>(cs1<span class="sc">$</span>result), <span class="at">df =</span> <span class="fu">df.residual</span>(cs1<span class="sc">$</span>result), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-13"><a href="mixed-effects-models.html#cb9-13" tabindex="-1"></a><span class="do">## [1] 0.2911469</span></span>
<span id="cb9-14"><a href="mixed-effects-models.html#cb9-14" tabindex="-1"></a>vcdExtra<span class="sc">::</span><span class="fu">LRstats</span>(cs1<span class="sc">$</span>result)</span>
<span id="cb9-15"><a href="mixed-effects-models.html#cb9-15" tabindex="-1"></a><span class="do">## Likelihood summary table:</span></span>
<span id="cb9-16"><a href="mixed-effects-models.html#cb9-16" tabindex="-1"></a><span class="do">##               AIC    BIC LR Chisq Df Pr(&gt;Chisq)</span></span>
<span id="cb9-17"><a href="mixed-effects-models.html#cb9-17" tabindex="-1"></a><span class="do">## cs1$result 112.09 125.11   102.09 95     0.2911</span></span></code></pre></div>
<p>These two deviances, the null and residual, are shown in the ANOVA summary. An ANOVA table shows the change in deviance from successively adding each variable to the model.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="mixed-effects-models.html#cb10-1" tabindex="-1"></a><span class="fu">anova</span>(cs1<span class="sc">$</span>result)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: heart_disease
## 
## Terms added sequentially (first to last)
## 
## 
##        Df Deviance Resid. Df Resid. Dev
## NULL                      99     129.49
## age     1  11.9074        98     117.58
## weight  1   9.1820        97     108.40
## VO2max  1   0.5045        96     107.89
## gender  1   5.8076        95     102.09</code></pre>
<p>Deviance residuals are one of four residuals you can calculate from a binary logistic regression.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> One is the <em>raw residual</em>, <span class="math inline">\(\epsilon_i = y_i - \hat{p}_i\)</span>, where <span class="math inline">\(\hat{p}_i\)</span> is the predicted probability. Another is the <em>Pearson residual</em>, <span class="math inline">\(r_i = \frac{\epsilon_i}{\sqrt{\hat{p}_i(1 - \hat{p}_i)}}\)</span>, the raw residual rescaled by dividing by the estimated standard deviation of a binomial distribution with 1 trial<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. A third is the <em>standardized Pearson residual</em>, <span class="math inline">\(rs_i = r_i / \sqrt{1 - \hat{h}_i}\)</span>, the Pearson residual adjusted for the leverage of the predictors using the hat-values. Hat-values measure the predictor distances from the mean. This residual is especially useful to evaluate model fit because if the model fits well, these residuals have a standard normal distribution. Finally, there are the <em>deviance residuals</em>, <span class="math inline">\(d_i = \mathrm{sign}(\epsilon_i) \left[ -2(y_i \log \hat{p}_i + (1 - y_i) \log (1 - \hat{p}_i)) \right]^{.5}\)</span>. Deviance Residuals measure how much the estimated probabilities differ from the observed proportions of success. You want deviance residuals to be evenly distributed (in absolute values, 1Q <span class="math inline">\(\approx\)</span> 3Q, min <span class="math inline">\(\approx\)</span> max). You also want the min and max to be &lt;3 because deviance residuals are roughly approximated by a standard normal distribution.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="mixed-effects-models.html#cb12-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb12-2"><a href="mixed-effects-models.html#cb12-2" tabindex="-1"></a>  <span class="at">Raw =</span> cs1<span class="sc">$</span>result <span class="sc">%&gt;%</span> <span class="fu">residuals</span>(<span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>(),</span>
<span id="cb12-3"><a href="mixed-effects-models.html#cb12-3" tabindex="-1"></a>  <span class="at">Pearson =</span> cs1<span class="sc">$</span>result <span class="sc">%&gt;%</span> <span class="fu">residuals</span>(<span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>(),</span>
<span id="cb12-4"><a href="mixed-effects-models.html#cb12-4" tabindex="-1"></a>  <span class="st">`</span><span class="at">Standardized Pearson</span><span class="st">`</span> <span class="ot">=</span> cs1<span class="sc">$</span>result <span class="sc">%&gt;%</span> <span class="fu">rstandard</span>(<span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>(),</span>
<span id="cb12-5"><a href="mixed-effects-models.html#cb12-5" tabindex="-1"></a>  <span class="at">Deviance =</span> cs1<span class="sc">$</span>result <span class="sc">%&gt;%</span> <span class="fu">residuals</span>(<span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>(),</span>
<span id="cb12-6"><a href="mixed-effects-models.html#cb12-6" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">&quot;Residual&quot;</span></span>
<span id="cb12-7"><a href="mixed-effects-models.html#cb12-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 7
##   Residual             Min.        `1st Qu.`   Median      Mean  `3rd Qu.` Max. 
##   &lt;chr&gt;                &lt;table[1d]&gt; &lt;table[1d]&gt; &lt;table[1d]&gt; &lt;tab&gt; &lt;table[1&gt; &lt;tab&gt;
## 1 Raw                  -0.7954587  -0.2500077  -0.1061849  -8.0… 0.3532839 0.91…
## 2 Pearson              -1.9720520  -0.5773622  -0.3446596  -1.8… 0.7391867 3.34…
## 3 Standardized Pearson -2.1794172  -0.5918874  -0.3521058  -2.1… 0.7592960 3.39…
## 4 Deviance             -1.7815642  -0.7585405  -0.4738051  -8.0… 0.9336278 2.23…</code></pre>
</div>
<div id="interpretation-3" class="section level3 unnumbered hasAnchor">
<h3>Interpretation<a href="mixed-effects-models.html#interpretation-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we look at the coefficient estimations, consider what it is they are predicting: the log odds of the binary response. To see what that means, plug in values for the explanatory variables to get predictions. <span class="math inline">\(\hat{y}\)</span> is the log odds of having heart disease.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="mixed-effects-models.html#cb14-1" tabindex="-1"></a>(mean_person <span class="ot">&lt;-</span> </span>
<span id="cb14-2"><a href="mixed-effects-models.html#cb14-2" tabindex="-1"></a>  cs1<span class="sc">$</span>dat <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="mixed-effects-models.html#cb14-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>caseno) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="mixed-effects-models.html#cb14-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">.by =</span> gender, <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean)))</span>
<span id="cb14-5"><a href="mixed-effects-models.html#cb14-5" tabindex="-1"></a><span class="do">##   gender      age   weight   VO2max</span></span>
<span id="cb14-6"><a href="mixed-effects-models.html#cb14-6" tabindex="-1"></a><span class="do">## 1   Male 40.79365 84.83270 46.40095</span></span>
<span id="cb14-7"><a href="mixed-effects-models.html#cb14-7" tabindex="-1"></a><span class="do">## 2 Female 41.62162 70.85324 38.91135</span></span>
<span id="cb14-8"><a href="mixed-effects-models.html#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="mixed-effects-models.html#cb14-9" tabindex="-1"></a>pred_log_odds <span class="ot">&lt;-</span> cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> mean_person, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb14-10"><a href="mixed-effects-models.html#cb14-10" tabindex="-1"></a><span class="fu">names</span>(pred_log_odds) <span class="ot">&lt;-</span> mean_person<span class="sc">$</span>gender</span>
<span id="cb14-11"><a href="mixed-effects-models.html#cb14-11" tabindex="-1"></a>pred_log_odds</span>
<span id="cb14-12"><a href="mixed-effects-models.html#cb14-12" tabindex="-1"></a><span class="do">##       Male     Female </span></span>
<span id="cb14-13"><a href="mixed-effects-models.html#cb14-13" tabindex="-1"></a><span class="do">## -0.3643411 -1.5819310</span></span></code></pre></div>
<p>Exponentiate to get the <strong>odds</strong>, <span class="math inline">\(\exp (\hat{y}) = \frac{\pi}{1 - \pi}\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="mixed-effects-models.html#cb15-1" tabindex="-1"></a>(pred_odds <span class="ot">&lt;-</span> <span class="fu">exp</span>(pred_log_odds))</span></code></pre></div>
<pre><code>##      Male    Female 
## 0.6946542 0.2055777</code></pre>
<p>Solve for <span class="math inline">\(\pi = \frac{\exp (\hat{y})}{1 + \exp (\hat{y})}\)</span> to get the <strong>probability</strong>. Do the math, or use <code>predict(type = "prob")</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="mixed-effects-models.html#cb17-1" tabindex="-1"></a>(pred_prob <span class="ot">&lt;-</span> pred_odds <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pred_odds))</span>
<span id="cb17-2"><a href="mixed-effects-models.html#cb17-2" tabindex="-1"></a><span class="do">##      Male    Female </span></span>
<span id="cb17-3"><a href="mixed-effects-models.html#cb17-3" tabindex="-1"></a><span class="do">## 0.4099091 0.1705222</span></span>
<span id="cb17-4"><a href="mixed-effects-models.html#cb17-4" tabindex="-1"></a>cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> mean_person, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb17-5"><a href="mixed-effects-models.html#cb17-5" tabindex="-1"></a><span class="do">## # A tibble: 2 × 2</span></span>
<span id="cb17-6"><a href="mixed-effects-models.html#cb17-6" tabindex="-1"></a><span class="do">##   .pred_No .pred_Yes</span></span>
<span id="cb17-7"><a href="mixed-effects-models.html#cb17-7" tabindex="-1"></a><span class="do">##      &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb17-8"><a href="mixed-effects-models.html#cb17-8" tabindex="-1"></a><span class="do">## 1    0.590     0.410</span></span>
<span id="cb17-9"><a href="mixed-effects-models.html#cb17-9" tabindex="-1"></a><span class="do">## 2    0.829     0.171</span></span></code></pre></div>
<p>Now let’s interpret the coefficients.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="mixed-effects-models.html#cb18-1" tabindex="-1"></a>cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept) -1.68       3.34      -0.503 0.615  
## 2 age          0.0851     0.0282     3.02  0.00251
## 3 weight       0.00573    0.0224     0.255 0.799  
## 4 VO2max      -0.0990     0.0479    -2.07  0.0389 
## 5 genderMale   1.95       0.842      2.31  0.0206</code></pre>
<p>The intercept term is the log-odds of heart disease for the reference case. The reference case in the model is <code>gender</code> = “Female”, <code>age</code> = 0, <code>weight</code> = 0, and <code>VO2max</code> = 0. If the data was centered, the reference case would actually meaningful.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="mixed-effects-models.html#cb20-1" tabindex="-1"></a>cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="mixed-effects-models.html#cb20-2" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="dv">0</span>, <span class="at">weight =</span> <span class="dv">0</span>, <span class="at">VO2max =</span> <span class="dv">0</span>, <span class="at">gender =</span> <span class="st">&quot;Female&quot;</span>), </span>
<span id="cb20-3"><a href="mixed-effects-models.html#cb20-3" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span></code></pre></div>
<pre><code>##         1 
## -1.676469</code></pre>
<p>Column “statistic” is the Wald <span class="math inline">\(z\)</span> statistic, <span class="math inline">\(z = \hat{\beta} / SE(\hat{\beta})\)</span>. Its square is the Wald chi-squared statistic. The <em>p</em>-value is the area to the right of <span class="math inline">\(z^2\)</span> in the <span class="math inline">\(\chi_1^2\)</span> density curve:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="mixed-effects-models.html#cb22-1" tabindex="-1"></a>cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="mixed-effects-models.html#cb22-2" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="mixed-effects-models.html#cb22-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.chisq =</span> <span class="fu">map_dbl</span>(statistic, <span class="sc">~</span><span class="fu">pchisq</span>(.<span class="sc">^</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="mixed-effects-models.html#cb22-4" tabindex="-1"></a>  <span class="fu">pull</span>(p.chisq)</span></code></pre></div>
<pre><code>## [1] 0.615297092 0.002511644 0.798578389 0.038885956 0.020648470</code></pre>
<p>Interpret the coefficient estimates as the change in the log odds of <span class="math inline">\(y\)</span> due to a one unit change in <span class="math inline">\(x\)</span>. If <span class="math inline">\(\delta = x_a - x_b\)</span>, then a <span class="math inline">\(\delta\)</span> change in <span class="math inline">\(x\)</span> is associated with a <span class="math inline">\(\delta \hat{\beta}\)</span> change in the log odds of <span class="math inline">\(y\)</span>. <span class="math inline">\(\beta\)</span> is the log odds ratio of <span class="math inline">\(x_a\)</span> vs <span class="math inline">\(x_b\)</span>.</p>
<p><span class="math display">\[\log \left(\pi / (1 - \pi) |_{x = x_a} \right) - \log \left(\pi / (1 - \pi) |_{x = x_b} \right) = \log \left( \frac{\pi / (1 - \pi) |_{x = x_a}}{\pi / (1 - \pi) |_{x = x_b}} \right) = \delta \hat{\beta}\]</span></p>
<p>The <em>exponential</em> of the coefficient estimates is the change in the <em>odds</em> of <span class="math inline">\(y\)</span> due to a <span class="math inline">\(\delta\)</span> change in <span class="math inline">\(x\)</span>. <span class="math inline">\(\exp \beta\)</span> is the odds ratio of <span class="math inline">\(x_a\)</span> vs <span class="math inline">\(x_b\)</span>.</p>
<p><span class="math display">\[\mathrm{odds}(y) = e^{\delta \hat{\beta}}\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="mixed-effects-models.html#cb24-1" tabindex="-1"></a>cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span> <span class="fu">tidy</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)    0.187    3.34      -0.503 0.615  
## 2 age            1.09     0.0282     3.02  0.00251
## 3 weight         1.01     0.0224     0.255 0.799  
## 4 VO2max         0.906    0.0479    -2.07  0.0389 
## 5 genderMale     7.03     0.842      2.31  0.0206</code></pre>
<p>All covariates held equal, a male’s log odds of heart disease are 1.95 times that of a female’s (log(OR)). A male’s odds are 7.03 times that of a female’s (OR). Of course, all covariate’s are <em>not</em> equal - males are heavier and have higher VO2max. Let’s run the calculations with the mean predictor values for male and female.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="mixed-effects-models.html#cb26-1" tabindex="-1"></a><span class="co"># Log OR</span></span>
<span id="cb26-2"><a href="mixed-effects-models.html#cb26-2" tabindex="-1"></a>pred_log_odds[<span class="st">&quot;Male&quot;</span>] <span class="sc">/</span> pred_log_odds[<span class="st">&quot;Female&quot;</span>]</span>
<span id="cb26-3"><a href="mixed-effects-models.html#cb26-3" tabindex="-1"></a><span class="do">##      Male </span></span>
<span id="cb26-4"><a href="mixed-effects-models.html#cb26-4" tabindex="-1"></a><span class="do">## 0.2303142</span></span>
<span id="cb26-5"><a href="mixed-effects-models.html#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="mixed-effects-models.html#cb26-6" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb26-7"><a href="mixed-effects-models.html#cb26-7" tabindex="-1"></a>pred_odds[<span class="st">&quot;Male&quot;</span>] <span class="sc">/</span> pred_odds[<span class="st">&quot;Female&quot;</span>]</span>
<span id="cb26-8"><a href="mixed-effects-models.html#cb26-8" tabindex="-1"></a><span class="do">##     Male </span></span>
<span id="cb26-9"><a href="mixed-effects-models.html#cb26-9" tabindex="-1"></a><span class="do">## 3.379034</span></span></code></pre></div>
<p>A one-unit increase in any of the continuous independent variables is interpreted similarly. The reference level is unimportant since the change is constant across the range of values. A one year increase in age increases the log-odds of heart disease by a factor of 0.09, and the odds by a factor of 1.09. To calculate the effect of a <em>decade</em> increase in age, multiply <span class="math inline">\(\beta\)</span> by 10 before exponentiating, or raise the exponentiated coeficient by 10. The effect of a 10-year increase in age is to increase the odds of heart disease by 2.34. The odds double every ten years.</p>
<p><code>oddsratio::or_glm()</code> is a handy way to calculate odds ratios from arbitrary increments to the predictors. Here are the ORs of a 10-year age change, 10 kg weight change, and VO2max change of 5.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="mixed-effects-models.html#cb27-1" tabindex="-1"></a>oddsratio<span class="sc">::</span><span class="fu">or_glm</span>(</span>
<span id="cb27-2"><a href="mixed-effects-models.html#cb27-2" tabindex="-1"></a>  cs1<span class="sc">$</span>dat, </span>
<span id="cb27-3"><a href="mixed-effects-models.html#cb27-3" tabindex="-1"></a>  cs1<span class="sc">$</span>result, </span>
<span id="cb27-4"><a href="mixed-effects-models.html#cb27-4" tabindex="-1"></a>  <span class="at">incr =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="dv">10</span>, <span class="at">weight =</span> <span class="dv">25</span>, <span class="at">VO2max =</span> <span class="sc">-</span><span class="dv">12</span>)</span>
<span id="cb27-5"><a href="mixed-effects-models.html#cb27-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##    predictor oddsratio ci_low (2.5) ci_high (97.5)          increment
## 1        age     2.342        1.391          4.270                 10
## 2     weight     1.154        0.381          3.572                 25
## 3     VO2max     3.281       11.033          1.124                -12
## 4 genderMale     7.026        1.428         40.155 Indicator variable</code></pre>
<p>Notice that the predicted probabilities have the sigmoidal shape of the binary relationship.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="mixed-effects-models.html#cb29-1" tabindex="-1"></a><span class="fu">augment</span>(cs1<span class="sc">$</span>fit, <span class="at">new_data =</span> cs1<span class="sc">$</span>dat, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="mixed-effects-models.html#cb29-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="mixed-effects-models.html#cb29-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(heart_disease <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>))) <span class="sc">+</span></span>
<span id="cb29-4"><a href="mixed-effects-models.html#cb29-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred_Yes), <span class="at">shape =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="mixed-effects-models.html#cb29-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred_Yes), <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="mixed-effects-models.html#cb29-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb29-7"><a href="mixed-effects-models.html#cb29-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-8"><a href="mixed-effects-models.html#cb29-8" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Binary Fitted Line Plot&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="mixed-effects-models.html#cb29-9" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Healthy&quot;</span>, <span class="st">&quot;Heart Disease&quot;</span>)) <span class="sc">+</span></span>
<span id="cb29-10"><a href="mixed-effects-models.html#cb29-10" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb29-11"><a href="mixed-effects-models.html#cb29-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<p><img src="supervised-ml_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="assumptions-3" class="section level3 unnumbered hasAnchor">
<h3>Assumptions<a href="mixed-effects-models.html#assumptions-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Four assumptions relate to the study design: (1) the dependent variable is dichotomous; (2) the observations are independent; (3) the categories of all nominal variables are mutually exclusive and exhaustive; and (4) there are at least 10 observations per dependent variable level and independent variable. These assumptions are all valid here. Three more assumptions related to the data distribution:</p>
<ul>
<li><p>There is a linear relationship between the logit transformation and the continuous independent variables. Test with a plot and with Box-Tidwell.</p></li>
<li><p>There is no independent variable multicollinearity. Test with correlation coefficients and variance inflation factors (VIF).</p></li>
<li><p>There are no influential outliers. Test with Cook’s distance.</p></li>
</ul>
<p>Test the linearity assumption first. There are two ways to do this (do both). First, fit your model, then plot the <em>fitted values</em> against the continuous predictors. This is the GLM analog to OLS bivariate analysis, except now the dependent variable is the <em>logit</em> transformation. These plotted relationships look pretty linear.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="mixed-effects-models.html#cb30-1" tabindex="-1"></a>cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="mixed-effects-models.html#cb30-2" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> cs1<span class="sc">$</span>dat) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="mixed-effects-models.html#cb30-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(age, weight, VO2max)) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="mixed-effects-models.html#cb30-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> .pred_Yes)) <span class="sc">+</span></span>
<span id="cb30-5"><a href="mixed-effects-models.html#cb30-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-6"><a href="mixed-effects-models.html#cb30-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(name), <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="mixed-effects-models.html#cb30-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y~x&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="mixed-effects-models.html#cb30-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Linearity Test: predicted vs continuous predictors&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="supervised-ml_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>The second test for linearity is the Box-Tidwell approach. Add transformations of the continuous independent variables to the model, <span class="math inline">\(x_{Tx} = x \log x\)</span>, then test their significance level in the fit.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="mixed-effects-models.html#cb31-1" tabindex="-1"></a><span class="co"># Using non-centered vars to avoid log(0) errors.</span></span>
<span id="cb31-2"><a href="mixed-effects-models.html#cb31-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> </span>
<span id="cb31-3"><a href="mixed-effects-models.html#cb31-3" tabindex="-1"></a>  cs1<span class="sc">$</span>dat <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="mixed-effects-models.html#cb31-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-5"><a href="mixed-effects-models.html#cb31-5" tabindex="-1"></a>    <span class="at">age_tx =</span> <span class="fu">log</span>(age) <span class="sc">*</span> age,</span>
<span id="cb31-6"><a href="mixed-effects-models.html#cb31-6" tabindex="-1"></a>    <span class="at">weight_tx =</span> <span class="fu">log</span>(weight) <span class="sc">*</span> weight,</span>
<span id="cb31-7"><a href="mixed-effects-models.html#cb31-7" tabindex="-1"></a>    <span class="at">VO2max_tx =</span> <span class="fu">log</span>(VO2max) <span class="sc">*</span> VO2max</span>
<span id="cb31-8"><a href="mixed-effects-models.html#cb31-8" tabindex="-1"></a>  )</span>
<span id="cb31-9"><a href="mixed-effects-models.html#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="mixed-effects-models.html#cb31-10" tabindex="-1"></a>cs1<span class="sc">$</span>boxtidwell_fit <span class="ot">&lt;-</span> </span>
<span id="cb31-11"><a href="mixed-effects-models.html#cb31-11" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="mixed-effects-models.html#cb31-12" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="mixed-effects-models.html#cb31-13" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="mixed-effects-models.html#cb31-14" tabindex="-1"></a>  <span class="fu">fit</span>(heart_disease <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> VO2max <span class="sc">+</span> gender <span class="sc">+</span> </span>
<span id="cb31-15"><a href="mixed-effects-models.html#cb31-15" tabindex="-1"></a>        age_tx <span class="sc">+</span> weight_tx <span class="sc">+</span> VO2max_tx, </span>
<span id="cb31-16"><a href="mixed-effects-models.html#cb31-16" tabindex="-1"></a>      <span class="at">data =</span> x)</span>
<span id="cb31-17"><a href="mixed-effects-models.html#cb31-17" tabindex="-1"></a></span>
<span id="cb31-18"><a href="mixed-effects-models.html#cb31-18" tabindex="-1"></a>cs1<span class="sc">$</span>boxtidwell_fit <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code></pre></div>
<pre><code>## # A tibble: 8 × 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept) -40.6       21.7      -1.87   0.0615
## 2 age           2.73       1.10      2.47   0.0135
## 3 weight        0.144      0.783     0.184  0.854 
## 4 VO2max        1.32       1.82      0.724  0.469 
## 5 genderMale    1.85       0.922     2.01   0.0443
## 6 age_tx       -0.543      0.227    -2.40   0.0164
## 7 weight_tx    -0.0266     0.146    -0.182  0.855 
## 8 VO2max_tx    -0.301      0.382    -0.788  0.431</code></pre>
<p>Focus on the three transformed variables. <code>age_tx</code> is the only one with a <em>p</em>-value nearly &lt;.05, but it is customary to apply a Bonferroni adjustment when testing for linearity. There are eight predictors in the model (including the intercept term), so the Bonferroni adjusted <em>p</em>-value for <code>age_tx</code> is multiplied by 8. Do not reject the null hypothesis of linearity.</p>
<p>If the relationship <em>was</em> nonlinear, you could try transforming the variable by raising it to <span class="math inline">\(\lambda = 1 + b / \gamma\)</span> where <span class="math inline">\(b\)</span> is the estimated coefficient of the model without the interaction terms, and <span class="math inline">\(\gamma\)</span> is the estimated coefficient of the interaction term of the model with interactions. For <code>age</code>, <span class="math inline">\(b\)</span> is 0.085 and <span class="math inline">\(\gamma\)</span> is -0.543, so <span class="math inline">\(\lambda\)</span> = 0.843. This is approximately 1 (no transformation). It appears to be customary to apply general transformations like .5 (square root), 1/3 (cube root), ln, and the reciprocal.</p>
<p>Now check for multicollinearity. Variance inflation factors (VIF) estimate how much the variance of a regression coefficient is inflated due to multicollinearity. When independent variables are correlated, it is difficult to say which variable really influences the dependent variable. The VIF for variable <span class="math inline">\(i\)</span> is</p>
<p><span class="math display">\[
\mathrm{VIF}_i = \frac{1}{1 - R_i^2}
\]</span></p>
<p>where <span class="math inline">\(R_i^2\)</span> is the coefficient of determination (i.e., the proportion of dependent variance explained by the model) of a regression of <span class="math inline">\(X_i\)</span> against all of the other predictors, <span class="math inline">\(X_i = X_{j \ne i} \beta + \epsilon\)</span>. If <span class="math inline">\(X_i\)</span> is totally unrelated to its covariates, then <span class="math inline">\(R_i^2\)</span> will be zero and <span class="math inline">\(\mathrm{VIF}_i\)</span> will be 1. If <span class="math inline">\(R_i^2\)</span> is .8, <span class="math inline">\(\mathrm{VIF}_i\)</span> will be 5. The rule of thumb is that <span class="math inline">\(R_i^2 \le 5\)</span> is tolerable, and <span class="math inline">\(R_i^2 &gt; 5\)</span> is “highly correlated” and you have to do something about it. These are excellent.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="mixed-effects-models.html#cb33-1" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(cs1<span class="sc">$</span>result)</span></code></pre></div>
<pre><code>##      age   weight   VO2max   gender 
## 1.035274 1.900575 2.167067 2.502538</code></pre>
<p>Try calculating the <span class="math inline">\(\mathrm{VIF}\)</span> for <code>age</code>.</p>
<div class="rmdnote">
<p>I don’t know why this doesn’t work. It <em>would</em> work if the underlying model was OLS instead of GLM. The answer seems to be related to GVIF vs VIF, but I didn’t figure it out.)</p>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="mixed-effects-models.html#cb35-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(age <span class="sc">~</span> weight <span class="sc">+</span> VO2max <span class="sc">+</span> gender, <span class="at">data =</span> cs1<span class="sc">$</span>dat_training) <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="mixed-effects-models.html#cb35-2" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&quot;r.squared&quot;</span>)</span>
<span id="cb35-3"><a href="mixed-effects-models.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="mixed-effects-models.html#cb35-4" tabindex="-1"></a>(vif <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> r2))</span>
<span id="cb35-5"><a href="mixed-effects-models.html#cb35-5" tabindex="-1"></a><span class="do">## [1] 1.049814</span></span></code></pre></div>
<p>Now check for influential outliers. Predict the response probabilities and filter for the predictions more than two standard deviations from the actual value and a Cook’s Distance greater than 4/N = 0.04.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> Cook’s distance measures how much predicted values change when observation <em>i</em> is removed from the data. Only two fitted values were both an outlier and influential, row ids 59 and 70. An index plot of Cook’s Distance shows the two points at the far left. You might examine the observations for validity. Otherwise, proceed and explain that there were two standardized residuals with value of 2.01 and 2.27 standard deviations which were kept in the analysis.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="mixed-effects-models.html#cb36-1" tabindex="-1"></a><span class="fu">augment</span>(cs1<span class="sc">$</span>result) <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="mixed-effects-models.html#cb36-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-3"><a href="mixed-effects-models.html#cb36-3" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">row_number</span>(),</span>
<span id="cb36-4"><a href="mixed-effects-models.html#cb36-4" tabindex="-1"></a>    <span class="at">outlier =</span> <span class="fu">if_else</span>(<span class="fu">abs</span>(.std.resid) <span class="sc">&gt;=</span> <span class="dv">2</span>, <span class="st">&quot;Outlier&quot;</span>, <span class="st">&quot;Other&quot;</span>),</span>
<span id="cb36-5"><a href="mixed-effects-models.html#cb36-5" tabindex="-1"></a>    <span class="at">influential =</span> <span class="fu">if_else</span>(.cooksd <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(cs1<span class="sc">$</span>dat), <span class="st">&quot;Influential&quot;</span>, <span class="st">&quot;Other&quot;</span>),</span>
<span id="cb36-6"><a href="mixed-effects-models.html#cb36-6" tabindex="-1"></a>    <span class="at">status =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-7"><a href="mixed-effects-models.html#cb36-7" tabindex="-1"></a>      outlier <span class="sc">==</span> <span class="st">&quot;Outlier&quot;</span> <span class="sc">&amp;</span> influential <span class="sc">==</span> <span class="st">&quot;Influential&quot;</span> <span class="sc">~</span> <span class="st">&quot;Influential Outlier&quot;</span>,</span>
<span id="cb36-8"><a href="mixed-effects-models.html#cb36-8" tabindex="-1"></a>      outlier <span class="sc">==</span> <span class="st">&quot;Outlier&quot;</span> <span class="sc">~</span> <span class="st">&quot;Outlier&quot;</span>,</span>
<span id="cb36-9"><a href="mixed-effects-models.html#cb36-9" tabindex="-1"></a>      influential <span class="sc">==</span> <span class="st">&quot;Influential&quot;</span> <span class="sc">~</span> <span class="st">&quot;Influential&quot;</span>,</span>
<span id="cb36-10"><a href="mixed-effects-models.html#cb36-10" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb36-11"><a href="mixed-effects-models.html#cb36-11" tabindex="-1"></a>    )</span>
<span id="cb36-12"><a href="mixed-effects-models.html#cb36-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="mixed-effects-models.html#cb36-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .cooksd)) <span class="sc">+</span></span>
<span id="cb36-14"><a href="mixed-effects-models.html#cb36-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status)) <span class="sc">+</span></span>
<span id="cb36-15"><a href="mixed-effects-models.html#cb36-15" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>(influential <span class="sc">==</span> <span class="st">&quot;Influential&quot;</span>, id, <span class="cn">NA_integer_</span>)), </span>
<span id="cb36-16"><a href="mixed-effects-models.html#cb36-16" tabindex="-1"></a>            <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">nudge_x =</span> .<span class="dv">025</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="mixed-effects-models.html#cb36-17" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(cs1<span class="sc">$</span>dat), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span> </span>
<span id="cb36-18"><a href="mixed-effects-models.html#cb36-18" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Influential Outlier&quot;</span> <span class="ot">=</span> <span class="st">&quot;firebrick&quot;</span>, </span>
<span id="cb36-19"><a href="mixed-effects-models.html#cb36-19" tabindex="-1"></a>                                <span class="st">&quot;Influential&quot;</span> <span class="ot">=</span> <span class="st">&quot;goldenrod&quot;</span>,</span>
<span id="cb36-20"><a href="mixed-effects-models.html#cb36-20" tabindex="-1"></a>                                <span class="st">&quot;Outlier&quot;</span> <span class="ot">=</span> <span class="st">&quot;slategray&quot;</span>,</span>
<span id="cb36-21"><a href="mixed-effects-models.html#cb36-21" tabindex="-1"></a>                                <span class="st">&quot;Other&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb36-22"><a href="mixed-effects-models.html#cb36-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-23"><a href="mixed-effects-models.html#cb36-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Index Plot of Cook&#39;s Distance.&quot;</span>,</span>
<span id="cb36-24"><a href="mixed-effects-models.html#cb36-24" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Row id labeled for values &gt; 4 / N.&quot;</span>)</span></code></pre></div>
<p><img src="supervised-ml_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="evaluate-the-fit-3" class="section level3 unnumbered hasAnchor">
<h3>Evaluate the Fit<a href="mixed-effects-models.html#evaluate-the-fit-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are several ways to evaluate the model fit.</p>
<ul>
<li>The likelihood ratio test</li>
<li>Pseudo R-squared<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</li>
<li>Accuracy measures</li>
<li>Gain and ROC curves</li>
</ul>
<p>The <strong>likelihood ratio test</strong> compares the log likelihood of the fitted model to an intercept-only model.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="mixed-effects-models.html#cb37-1" tabindex="-1"></a>intercept_only <span class="ot">&lt;-</span></span>
<span id="cb37-2"><a href="mixed-effects-models.html#cb37-2" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="mixed-effects-models.html#cb37-3" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="mixed-effects-models.html#cb37-4" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="mixed-effects-models.html#cb37-5" tabindex="-1"></a>  <span class="fu">fit</span>(heart_disease <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> cs1<span class="sc">$</span>dat)</span>
<span id="cb37-6"><a href="mixed-effects-models.html#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="mixed-effects-models.html#cb37-7" tabindex="-1"></a>(cs1<span class="sc">$</span>lrtest <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">lrtest</span>(cs1<span class="sc">$</span>result, intercept_only<span class="sc">$</span>fit))</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: heart_disease ~ age + weight + VO2max + gender
## Model 2: heart_disease ~ 1
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   5 -51.044                         
## 2   1 -64.745 -4 27.402  1.649e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The fitted model is significant, <span class="math inline">\(\chi^2\)</span>(4) = 27.4, <em>p</em> &lt; .001. Calculate the pseuedo-R2 with <code>DescTools::PseudoR2()</code>.</p>
<div class="rmdnote">
<p>I Can’t get this to work in the tidymodels framework. Using <code>glm()</code> for now.</p>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="mixed-effects-models.html#cb39-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">glm</span>(heart_disease <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> VO2max <span class="sc">+</span> gender, </span>
<span id="cb39-2"><a href="mixed-effects-models.html#cb39-2" tabindex="-1"></a>         <span class="at">data =</span> cs1<span class="sc">$</span>dat,</span>
<span id="cb39-3"><a href="mixed-effects-models.html#cb39-3" tabindex="-1"></a>         <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb39-4"><a href="mixed-effects-models.html#cb39-4" tabindex="-1"></a>cs1<span class="sc">$</span>pseudo_r2 <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(x, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">&quot;CoxSnell&quot;</span>, <span class="st">&quot;Nagelkerke&quot;</span>, <span class="st">&quot;McFadden&quot;</span>))</span>
<span id="cb39-5"><a href="mixed-effects-models.html#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="mixed-effects-models.html#cb39-6" tabindex="-1"></a>cs1<span class="sc">$</span>pseudo_r2</span></code></pre></div>
<pre><code>##   CoxSnell Nagelkerke   McFadden 
##  0.2396799  0.3301044  0.2116126</code></pre>
<p>Laerd interprets this as the model explained 33.0% (Nagelkerke R2) of the variance in heart disease. This is how your would interpret R2 in an OLS model. <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/">UCLA</a> points out that the various pseudo R-squareds measure other aspects of the model and are unique to the measured quantity. A pseudo R-squared is not very informative on its own; it is useful for comparing models. Accuracy measures formed by the cross-tabulation of observed and predicted classes is the better way to go.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="mixed-effects-models.html#cb41-1" tabindex="-1"></a>cs1<span class="sc">$</span>conf_mat <span class="ot">&lt;-</span></span>
<span id="cb41-2"><a href="mixed-effects-models.html#cb41-2" tabindex="-1"></a>  cs1<span class="sc">$</span>fit <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="mixed-effects-models.html#cb41-3" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> cs1<span class="sc">$</span>dat) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="mixed-effects-models.html#cb41-4" tabindex="-1"></a>  <span class="co"># conf_mat requires truth to be first level of the factor variable.</span></span>
<span id="cb41-5"><a href="mixed-effects-models.html#cb41-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(heart_disease, .pred_class), <span class="sc">~</span><span class="fu">fct_relevel</span>(., <span class="st">&quot;Yes&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="mixed-effects-models.html#cb41-6" tabindex="-1"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> heart_disease, <span class="at">estimate =</span> .pred_class)</span>
<span id="cb41-7"><a href="mixed-effects-models.html#cb41-7" tabindex="-1"></a></span>
<span id="cb41-8"><a href="mixed-effects-models.html#cb41-8" tabindex="-1"></a>cs1<span class="sc">$</span>conf_mat</span>
<span id="cb41-9"><a href="mixed-effects-models.html#cb41-9" tabindex="-1"></a><span class="do">##           Truth</span></span>
<span id="cb41-10"><a href="mixed-effects-models.html#cb41-10" tabindex="-1"></a><span class="do">## Prediction Yes No</span></span>
<span id="cb41-11"><a href="mixed-effects-models.html#cb41-11" tabindex="-1"></a><span class="do">##        Yes  16 10</span></span>
<span id="cb41-12"><a href="mixed-effects-models.html#cb41-12" tabindex="-1"></a><span class="do">##        No   19 55</span></span>
<span id="cb41-13"><a href="mixed-effects-models.html#cb41-13" tabindex="-1"></a></span>
<span id="cb41-14"><a href="mixed-effects-models.html#cb41-14" tabindex="-1"></a>cs1<span class="sc">$</span>conf_mat <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb41-15"><a href="mixed-effects-models.html#cb41-15" tabindex="-1"></a><span class="do">## # A tibble: 13 × 3</span></span>
<span id="cb41-16"><a href="mixed-effects-models.html#cb41-16" tabindex="-1"></a><span class="do">##    .metric              .estimator .estimate</span></span>
<span id="cb41-17"><a href="mixed-effects-models.html#cb41-17" tabindex="-1"></a><span class="do">##    &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span id="cb41-18"><a href="mixed-effects-models.html#cb41-18" tabindex="-1"></a><span class="do">##  1 accuracy             binary         0.71 </span></span>
<span id="cb41-19"><a href="mixed-effects-models.html#cb41-19" tabindex="-1"></a><span class="do">##  2 kap                  binary         0.322</span></span>
<span id="cb41-20"><a href="mixed-effects-models.html#cb41-20" tabindex="-1"></a><span class="do">##  3 sens                 binary         0.457</span></span>
<span id="cb41-21"><a href="mixed-effects-models.html#cb41-21" tabindex="-1"></a><span class="do">##  4 spec                 binary         0.846</span></span>
<span id="cb41-22"><a href="mixed-effects-models.html#cb41-22" tabindex="-1"></a><span class="do">##  5 ppv                  binary         0.615</span></span>
<span id="cb41-23"><a href="mixed-effects-models.html#cb41-23" tabindex="-1"></a><span class="do">##  6 npv                  binary         0.743</span></span>
<span id="cb41-24"><a href="mixed-effects-models.html#cb41-24" tabindex="-1"></a><span class="do">##  7 mcc                  binary         0.330</span></span>
<span id="cb41-25"><a href="mixed-effects-models.html#cb41-25" tabindex="-1"></a><span class="do">##  8 j_index              binary         0.303</span></span>
<span id="cb41-26"><a href="mixed-effects-models.html#cb41-26" tabindex="-1"></a><span class="do">##  9 bal_accuracy         binary         0.652</span></span>
<span id="cb41-27"><a href="mixed-effects-models.html#cb41-27" tabindex="-1"></a><span class="do">## 10 detection_prevalence binary         0.26 </span></span>
<span id="cb41-28"><a href="mixed-effects-models.html#cb41-28" tabindex="-1"></a><span class="do">## 11 precision            binary         0.615</span></span>
<span id="cb41-29"><a href="mixed-effects-models.html#cb41-29" tabindex="-1"></a><span class="do">## 12 recall               binary         0.457</span></span>
<span id="cb41-30"><a href="mixed-effects-models.html#cb41-30" tabindex="-1"></a><span class="do">## 13 f_meas               binary         0.525</span></span>
<span id="cb41-31"><a href="mixed-effects-models.html#cb41-31" tabindex="-1"></a></span>
<span id="cb41-32"><a href="mixed-effects-models.html#cb41-32" tabindex="-1"></a>cs1<span class="sc">$</span>conf_mat <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="supervised-ml_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>The model accuracy, 71.0%, is the percent of observations correctly classified. The sensitivity, 45.7%, is the accuracy with regard to predicting positive cases. The specificity, 84.6%, is the accuracy with regard to predicting negative cases. If you are fitting a predictive model, use the testing data set for this.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="mixed-effects-models.html#cb42-1" tabindex="-1"></a>cs1<span class="sc">$</span>fit_training <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="mixed-effects-models.html#cb42-2" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> cs1<span class="sc">$</span>dat_testing) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="mixed-effects-models.html#cb42-3" tabindex="-1"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> heart_disease, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>##           Truth
## Prediction No Yes
##        No  16   5
##        Yes  4   6</code></pre>
<p>Finally, plot the <a href="https://community.tibco.com/wiki/gains-vs-roc-curves-do-you-understand-difference">gain curve or ROC curve</a>. In the <strong>gain curve</strong>, the x-axis is the fraction of items seen when sorted by the predicted value, and the y-axis is the cumulatively summed true outcome. The “wizard” curve is the gain curve when the data is sorted by the true outcome. If the model’s gain curve is close to the wizard curve, then the model predicts the response well. The gray area is the “gain” over a random prediction.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="mixed-effects-models.html#cb44-1" tabindex="-1"></a>cs1<span class="sc">$</span>dat_testing <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="mixed-effects-models.html#cb44-2" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(cs1<span class="sc">$</span>fit, <span class="at">new_data =</span> cs1<span class="sc">$</span>dat_testing, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="mixed-effects-models.html#cb44-3" tabindex="-1"></a>  <span class="co"># event_level = &quot;second&quot; sets the second level as success</span></span>
<span id="cb44-4"><a href="mixed-effects-models.html#cb44-4" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">gain_curve</span>(.pred_Yes, <span class="at">truth =</span> heart_disease, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="mixed-effects-models.html#cb44-5" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb44-6"><a href="mixed-effects-models.html#cb44-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gain Curve&quot;</span>)</span></code></pre></div>
<p><img src="supervised-ml_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>11 of the 31 participants had heart disease in the test data set.</p>
<ul>
<li>The gain curve encountered 6 heart disease cases (50%) within the first 8 observations (55%). It encountered all 11 heart disease cases on the 18th observation.</li>
<li>The bottom of the grey area is the outcome of a random model. Only half the heart disease cases would be observed within 50% of the observations.<br />
</li>
<li>The top of the grey area is the outcome of the perfect model, the “wizard curve”. Half the heart disease cases would be observed in 6/30=20% of the observations.</li>
</ul>
<p>The <strong>ROC</strong> (Receiver Operating Characteristics) curve plots sensitivity vs specificity at varying cut-off values for the probability ranging from 0 to 1. Ideally, you want very little trade-off between sensitivity and specificity, with a curve hugging the left and top axes.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="mixed-effects-models.html#cb45-1" tabindex="-1"></a>cs1<span class="sc">$</span>dat_testing <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="mixed-effects-models.html#cb45-2" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(cs1<span class="sc">$</span>fit, <span class="at">new_data =</span> cs1<span class="sc">$</span>dat_testing, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="mixed-effects-models.html#cb45-3" tabindex="-1"></a>  <span class="co"># event_level = &quot;second&quot; sets the second level as success</span></span>
<span id="cb45-4"><a href="mixed-effects-models.html#cb45-4" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(.pred_Yes, <span class="at">truth =</span> heart_disease, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="mixed-effects-models.html#cb45-5" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb45-6"><a href="mixed-effects-models.html#cb45-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ROC Curve&quot;</span>)</span></code></pre></div>
<p><img src="supervised-ml_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="reporting-3" class="section level3 unnumbered hasAnchor">
<h3>Reporting<a href="mixed-effects-models.html#reporting-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>A binomial logistic regression was performed to ascertain the effects of age, weight, gender and VO2max on the likelihood that participants have heart disease. Linearity of the continuous variables with respect to the logit of the dependent variable was assessed via the Box-Tidwell (1962) procedure. A Bonferroni correction was applied using all eight terms in the model resulting in statistical significance being accepted when <em>p</em> &lt; 0.00625 (Tabachnick &amp; Fidell, 2014). Based on this assessment, all continuous independent variables were found to be linearly related to the logit of the dependent variable. There were two standardized residuals with value of 2.01 and 2.27 standard deviations, which were kept in the analysis. The logistic regression model was statistically significant, χ2(4) = 27.40, p &lt; .001. The model explained 33.0% (Nagelkerke R2) of the variance in heart disease and correctly classified 71.0% of cases. Sensitivity was 45.7%, specificity was 84.6%, positive predictive value was and negative predictive value was . Of the five predictor variables only three were statistically significant: age, gender and VO2max (as shown in Table 1). Females had 0.14 times lower odds to exhibit heart disease than males. Increasing age was associated with an increased likelihood of exhibiting heart disease, but increasing VO2max was associated with a reduction in the likelihood of exhibiting heart disease.</p>
</blockquote>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="mixed-effects-models.html#cb46-1" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(</span>
<span id="cb46-2"><a href="mixed-effects-models.html#cb46-2" tabindex="-1"></a>  cs1<span class="sc">$</span>fit,</span>
<span id="cb46-3"><a href="mixed-effects-models.html#cb46-3" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span></span>
<span id="cb46-4"><a href="mixed-effects-models.html#cb46-4" tabindex="-1"></a>)</span></code></pre></div>
<div id="dmevsytvyn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dmevsytvyn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dmevsytvyn thead, #dmevsytvyn tbody, #dmevsytvyn tfoot, #dmevsytvyn tr, #dmevsytvyn td, #dmevsytvyn th {
  border-style: none;
}

#dmevsytvyn p {
  margin: 0;
  padding: 0;
}

#dmevsytvyn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dmevsytvyn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dmevsytvyn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dmevsytvyn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dmevsytvyn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmevsytvyn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmevsytvyn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmevsytvyn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dmevsytvyn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dmevsytvyn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dmevsytvyn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dmevsytvyn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dmevsytvyn .gt_spanner_row {
  border-bottom-style: hidden;
}

#dmevsytvyn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dmevsytvyn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dmevsytvyn .gt_from_md > :first-child {
  margin-top: 0;
}

#dmevsytvyn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dmevsytvyn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dmevsytvyn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dmevsytvyn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dmevsytvyn .gt_row_group_first td {
  border-top-width: 2px;
}

#dmevsytvyn .gt_row_group_first th {
  border-top-width: 2px;
}

#dmevsytvyn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmevsytvyn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dmevsytvyn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dmevsytvyn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmevsytvyn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmevsytvyn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dmevsytvyn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dmevsytvyn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dmevsytvyn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmevsytvyn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmevsytvyn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmevsytvyn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmevsytvyn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmevsytvyn .gt_left {
  text-align: left;
}

#dmevsytvyn .gt_center {
  text-align: center;
}

#dmevsytvyn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dmevsytvyn .gt_font_normal {
  font-weight: normal;
}

#dmevsytvyn .gt_font_bold {
  font-weight: bold;
}

#dmevsytvyn .gt_font_italic {
  font-style: italic;
}

#dmevsytvyn .gt_super {
  font-size: 65%;
}

#dmevsytvyn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dmevsytvyn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dmevsytvyn .gt_indent_1 {
  text-indent: 5px;
}

#dmevsytvyn .gt_indent_2 {
  text-indent: 10px;
}

#dmevsytvyn .gt_indent_3 {
  text-indent: 15px;
}

#dmevsytvyn .gt_indent_4 {
  text-indent: 20px;
}

#dmevsytvyn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;OR&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">age</td>
<td headers="estimate" class="gt_row gt_center">1.09</td>
<td headers="ci" class="gt_row gt_center">1.03, 1.16</td>
<td headers="p.value" class="gt_row gt_center">0.003</td></tr>
    <tr><td headers="label" class="gt_row gt_left">weight</td>
<td headers="estimate" class="gt_row gt_center">1.01</td>
<td headers="ci" class="gt_row gt_center">0.96, 1.05</td>
<td headers="p.value" class="gt_row gt_center">0.8</td></tr>
    <tr><td headers="label" class="gt_row gt_left">VO2max</td>
<td headers="estimate" class="gt_row gt_center">0.91</td>
<td headers="ci" class="gt_row gt_center">0.82, 0.99</td>
<td headers="p.value" class="gt_row gt_center">0.039</td></tr>
    <tr><td headers="label" class="gt_row gt_left">gender</td>
<td headers="estimate" class="gt_row gt_center"><br /></td>
<td headers="ci" class="gt_row gt_center"><br /></td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Female</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Male</td>
<td headers="estimate" class="gt_row gt_center">7.03</td>
<td headers="ci" class="gt_row gt_center">1.43, 40.2</td>
<td headers="p.value" class="gt_row gt_center">0.021</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> OR = Odds Ratio, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>

</div>
</div>
</div>
<h3>References<a href="references-1.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Brown2021" class="csl-entry">
Brown, Violet A. 2021. <span>“An Introduction to Linear Mixed-Effects Modeling in r.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 4 (1): 2515245920960351. <a href="https://doi.org/10.1177/2515245920960351">https://doi.org/10.1177/2515245920960351</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Notes from <a href="https://machinelearningmastery.com/logistic-regression-with-maximum-likelihood-estimation/">Machine Learning Mastery</a>.<a href="mixed-effects-models.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="https://data.library.virginia.edu/understanding-deviance-residuals/">UVA</a> discusses the four types of residuals you can calculate from a binary logistic regression.<a href="mixed-effects-models.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>See probability notes on the binomial distribution <a href="https://bookdown.org/mpfoley1973/probability/binomial.html">here</a><a href="mixed-effects-models.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p><a href="https://towardsdatascience.com/assumptions-of-logistic-regression-clearly-explained-44d85a22b290">This article</a> suggests using three standard deviations for an outliers threshold.<a href="mixed-effects-models.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Nice explanation <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/">here</a>. Sounds like you should use pseudo R2 for model comparison, not for reporting goodness of fit<a href="mixed-effects-models.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="BayesRegression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["supervised-ml.pdf", "supervised-ml.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
